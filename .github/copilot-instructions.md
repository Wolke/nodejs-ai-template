# Copilot Collaboration Instructions

æœ¬å°ˆæ¡ˆæ¡ç”¨ **å…§éƒ¨å¥—ä»¶åŒ– + ä½µè¡Œå°è©±å·¥ä½œæµ**ï¼Œç¢ºä¿å¤§å‹ TypeScript monorepo åœ¨ Copilot / GPT ç³»çµ±ä¸­ä¿æŒæ¸…æ™°ä¸Šä¸‹æ–‡ä¸¦åŠ é€Ÿå”ä½œã€‚

## âœ¨ æµç¨‹ç¸½è¦½

| Stage                           | ç›®çš„                                         | ä¸»è¦è¼¸å‡ºç‰©                          |
| ------------------------------- | ------------------------------------------ | ------------------------------ |
| 0ï¸âƒ£ Architecture Kickâ€‘off       | èˆ‡ä½¿ç”¨è€…ï¼ˆæˆ– Tech Leadï¼‰ç¢ºèªæ•´é«” monorepo æ¶æ§‹èˆ‡æ¯å€‹å¥—ä»¶é‚Šç•Œ   | âœ… é©—æ”¶æ¸…å–®ï¼ˆArchitecture Checklistï¼‰ |
| 1ï¸âƒ£ Task Definition per Package | ç‚º **æ¯å€‹å¥—ä»¶** å®šç¾©ä¸€ä»½ TaskÂ Briefï¼ˆéœ€æ±‚ + Done å®šç¾©ï¼‰   | `tasks/<package>.md`           |
| 2ï¸âƒ£ Threaded Execution          | ä¾ TaskÂ Brief é–‹å•Ÿ **ç¨ç«‹å°è©±ä¸²**ï¼›å¯å¤šå€‹ Copilot å¯¦ä¾‹ä¸¦è¡Œ | PR åˆ†æ”¯ + å–®å…ƒæ¸¬è©¦                   |
| 3ï¸âƒ£ MergeÂ &Â Review              | Rebaseï¼åˆä½µä¸¦çµ±æ•´ changelogã€ç‰ˆæœ¬è™Ÿ                 | åˆä½µè‡³ `main`                     |

---

## 0ï¸âƒ£Â Architecture Kickâ€‘off

1. **ç”¢å‡ºæ¶æ§‹è‰åœ–**
   â€¢Â Monorepo ç›®éŒ„çµæ§‹ï¼ˆ`packages/<pkg>/src`ï¼‰
   â€¢Â äº¤äº’é—œä¿‚ï¼šèª°ä¾è³´èª°ã€å…¬å…±å‹åˆ¥ä½ç½®
2. **æ ¸å°æ¸…å–®**

   * [ ] æ¯å€‹å¥—ä»¶æ“æœ‰å–®ä¸€è²¬ä»»Â (SRP)
   * [ ] æš´éœ²Â APIÂ é€é `index.ts` **named exports**
   * [ ] æ¸¬è©¦ç­–ç•¥ï¼ˆå–®å…ƒï¼e2eï¼‰å·²å°é½Š
   * [ ] CIÂ jobï¼ˆbuildÂ +Â testÂ +Â lintï¼‰æ¶µè“‹æ ¹èˆ‡å„å¥—ä»¶

> **â€¼ï¸ åœ¨æœªå…¨éƒ¨å‹¾é¸å‰ï¼Œä¸å¾—é€²å…¥ä¸‹ä¸€éšæ®µã€‚**

---

## 1ï¸âƒ£Â Task Definition per Package

TaskÂ BriefÂ æ”¾æ–¼ `tasks/<package>.md`ï¼Œç¯„æœ¬å¦‚ä¸‹ï¼š

```md
# Task: @myproject/string-utils

## éœ€æ±‚
- ä¸å¼•å…¥ç¬¬ä¸‰æ–¹Â lib
- 100%Â testÂ coverageÂ (Vitest)
- index.ts æœ‰Â JSDoc è¨»è§£ ï¼Œå…¶ä»–æª”æ¡ˆçš„å…§å®¹è¶Šç²¾ç°¡è¶Šå¥½ï¼Œä¾‹å¦‚ï¼šå…§éƒ¨å‡½å¼è®Šæ•¸åç¨±ä¿æŒç°¡å–® ç›´æ¥å–å« a b c
- å…ˆè¦åŠƒå¥½ test åœ¨å¯¦ä½œå…¶ä»–ç¨‹å¼ç¢¼

## DoneÂ Definition
- [ ] index.ts æœ‰Â JSDoc è¨»è§£ 
- [ ] `pnpm --filter string-utils test` é€šé
- [ ] READMEÂ ç¯„ä¾‹å¯ç›´æ¥åŸ·è¡Œ
```

> æ¯æ”¯Â TaskÂ Brief **ä¸€æª”ä¸€è²¬**ï¼Œä¸¦ä»¥åŒååˆ†æ”¯é–‹ç™¼ï¼š`feature/string-utils`ã€‚

**âš ï¸ å®Œæˆ TaskÂ Brief å¾Œï¼Œè«‹å…ˆï¼š**

1. åœ¨ `tasks/overview.md` æ›´æ–°ç‹€æ…‹èˆ‡å„ªå…ˆç´šã€‚
2. ç­‰å¾…æ’ç¨‹ï¼å¯©æ ¸ç¢ºèªï¼ˆæˆ–å…¶ä»– Task ä¾è³´è§£é™¤ï¼‰å¾Œï¼Œå†å•Ÿå‹• 2ï¸âƒ£Â ThreadedÂ Executionã€‚
   *åˆ‡å‹¿ç«‹åˆ»é–‹å§‹æ’°å¯«ç¨‹å¼ç¢¼ï¼**å¿…é ˆç­‰å¾… Maintainer / TechÂ Lead æ¸…æ¥šä¸‹é”ã€ŒSTARTÂ CODINGã€æŒ‡ä»¤å¾Œï¼Œæ–¹å¯é€²å…¥ 2ï¸âƒ£Â ThreadedÂ Executionã€‚***

---

## ğŸ“‹ TaskÂ Overviewï¼ˆç¸½è¡¨.mdï¼‰

åœ¨ `tasks/overview.md` ç¶­è­· **æ‰€æœ‰ TaskÂ Brief çš„ç‹€æ…‹èˆ‡å„ªå…ˆé †åº**ã€‚

| Package      | ç‹€æ…‹ | å„ªå…ˆç´š | å‚™è¨»              |
| ------------ | -- | --- | --------------- |
| string-utils | ğŸ†• | P1  | åŸºç¤å·¥å…·            |
| billing-core | ğŸš§ | P2  | ä¾è³´ string-utils |

* **ç‹€æ…‹åœ–ä¾‹**ï¼šğŸ†•Â å¾…é–‹ç™¼ï½œğŸš§Â é–‹ç™¼ä¸­ï½œâœ…Â å®Œæˆï½œğŸ”„Â é‡æ§‹ä¸­
* æ¯å®Œæˆ / æ–°å¢ Task æ™‚ç«‹å³æ›´æ–°æ­¤è¡¨ï¼Œä¿æŒå…¨å°ˆæ¡ˆå…±è­˜ã€‚

---

## 2ï¸âƒ£Â ThreadedÂ Execution

* **é–‹æ–°å°è©±ä¸²**ï¼šæ¨™é¡Œæ ¼å¼ `TASK: <package>`
* **å»ºç«‹å°ˆå±¬åˆ†æ”¯**ï¼šå‘½åç‚º `feature/<package>` æˆ– `task/<package>`ï¼Œæ‰€æœ‰ commit å‡æ–¼æ­¤åˆ†æ”¯é€²è¡Œ
* **ä¾è³´åƒè€ƒæœ€å°åŒ–**ï¼šè‹¥æ­¤ Task éœ€å‘¼å«å…¶ä»–å…§éƒ¨å¥—ä»¶ï¼ŒCopilot åƒ…éœ€æŸ¥çœ‹è©²å¥—ä»¶çš„ `index.ts`ã€`README.md` åŠ `tests/` ç›®éŒ„ä¾†ç†è§£ API è¡Œç‚ºï¼Œ**åˆ‡å‹¿æ·±å…¥é–±è®€å…¶å…§éƒ¨å¯¦ä½œæª”æ¡ˆ**ï¼Œä»¥ä¿æŒä¸Šä¸‹æ–‡ç²¾ç°¡
* **æ–‡ä»¶å¯è®€æ€§è¦æ±‚**ï¼šæ’°å¯«æœ¬å¥—ä»¶æ™‚ï¼Œå‹™å¿…å®Œå–„ `index.ts`ã€`README.md` åŠ `tests/` å…§å®¹ï¼Œç¢ºä¿å¾ŒçºŒé–‹ç™¼è€…èƒ½å¿«é€ŸæŒæ¡å¥—ä»¶ç‰¹æ€§èˆ‡ä½¿ç”¨æ–¹å¼
* å…è¨± **å¤šå€‹ Copilot session** å¹³è¡Œè™•ç†ä¸åŒå¥—ä»¶ï¼Œä»¥ PR ç·¨è™Ÿåˆ†æµ
* ä»»å‹™å®Œæˆ â†’ æäº¤ PR + ç°¡æ˜“èªªæ˜ï¼ˆautoâ€‘generated changelog äº¦å¯ï¼‰

---

## 3ï¸âƒ£Â MergeÂ &Â Review

1. é›†ä¸­ CodeÂ Reviewï¼Œç¢ºèªï¼š
   â€¢Â TaskÂ BriefÂ çš„ *Done*Â æ˜¯å¦å…¨éƒ¨å‹¾é¸
   â€¢Â å¥—ä»¶é–“ä¾è³´ç„¡å¾ªç’°
2. é€šéå¾Œï¼š

   ```bash
   pnpm -r version patch # æˆ–é©ç•¶ semver
   ```

   â€¢Â MergeÂ &Â Tag
   â€¢Â Optionalï¼šå•Ÿå‹•è‡ªå‹•ç™¼å¸ƒï¼ç™¼åŒ…æµç¨‹

---

## CopilotÂ Tips

* **é‹è¡Œæ¨¡å¼æª¢æŸ¥**ï¼šé–‹å§‹ä»»ä½• Task å‰ï¼Œå…ˆç¢ºèª Copilot æ˜¯å¦è™•æ–¼ *AgentÂ mode*ï¼›è‹¥æ˜¯ï¼ŒCopilot å¯ä»¥è‡ªè¡Œæ–°å¢ï¼ä¿®æ”¹æª”æ¡ˆï¼Œç„¡éœ€äººå·¥ä¸‹æŒ‡ä»¤ã€‚
* **ç­‰å¾…å•Ÿå‹•æŒ‡ä»¤**ï¼šå®Œæˆ TaskÂ Brief å¾Œï¼Œ**è«‹å¿½ç•¥ä»»ä½•å¯¦ä½œç›¸é—œçš„æç¤ºï¼Œç›´è‡³ Maintainer / TechÂ Lead æ˜ç¢ºè¼¸å…¥ `START CODING`ã€‚**
* **å„ªå…ˆå¼•ç”¨** å…§éƒ¨å¥—ä»¶Â APIï¼ˆå¦‚ `@myproject/string-utils`ï¼‰ã€‚
* è‹¥ç™¼ç¾é‡è¤‡å¯¦ä½œï¼Œè«‹æ›´æ–°Â TaskÂ Brief æˆ–æå‡ºé‡æ§‹å»ºè­°ã€‚
* **ç¦æ­¢** åœ¨å–®ä¸€å°è©±åŒæ™‚ä¿®æ”¹å¤šå€‹å¥—ä»¶ã€‚

---

## Example Package

```ts
// packages/string-utils/src/index.ts
export function countChar(str: string, char: string) {
  return [...str].filter(c => c === char).length;
}
```

```jsonc
// packages/string-utils/package.json
{
  "name": "@myproject/string-utils",
  "version": "1.0.0",
  "main": "dist/index.js",
  "types": "dist/index.d.ts"
}
```

---

## æ³¨æ„äº‹é …

* æ¯æ¬¡é‡æ§‹éƒ½ **å…ˆ** é·ç§»å‘¼å«ç«¯ â†’ **å¾Œ** åˆªèˆŠç¢¼ã€‚
* ä»»ä½•Â breakingÂ changeÂ è«‹åœ¨Â TaskÂ BriefÂ æ˜ç¢ºæ¨™ç¤ºã€‚
* **Architecture Checklist å®Œæˆ** å¾Œæ‰èƒ½å•Ÿå‹•ç¬¬ä¸€å€‹Â Taskã€‚
* **æ¯å€‹ TaskÂ Brief å¿…é ˆç¨ç«‹ï¼Œç¦æ­¢åœ¨å–®ä¸€å°è©±ä¸²åŒæ™‚ä¿®æ”¹å¤šå€‹å¥—ä»¶ã€‚**
